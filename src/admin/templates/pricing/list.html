{% extends "base.html" %}

{% block title %}–¶–µ–Ω—ã{% endblock %}
{% block page_title %}üí∞ –¶–µ–Ω—ã –Ω–∞ —É—Å–ª—É–≥–∏{% endblock %}

{% block header_actions %}
<a href="/admin/pricing/new" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—É</a>
{% endblock %}

{% block content %}
{% if rules %}
<table class="data-table">
    <thead>
        <tr>
            <th>–í–∏–¥ —Ä–∞–±–æ—Ç</th>
            <th>–ú–∞—Ä–∫–∞</th>
            <th>–ú–æ–¥–µ–ª—å</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–£—Ä–æ–≤–µ–Ω—å</th>
            <th>–ì–∞—Ä–∞–Ω—Ç–∏—è</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for rule in rules %}
        <tr id="rule-{{ rule.id }}">
            <td>
                {% if rule.repair_type_id and repair_types.get(rule.repair_type_id|string) %}
                {{ repair_types[rule.repair_type_id|string].name_ru }}
                {% else %}
                –í—Å–µ –≤–∏–¥—ã
                {% endif %}
            </td>
            <td>{{ rule.device_brand or '–õ—é–±–∞—è' }}</td>
            <td>{{ rule.device_model_pattern or '–õ—é–±–∞—è' }}</td>
            <td>
                <strong>{{ '{:,.0f}'.format(rule.price_min|float) }} ‚Äì {{ '{:,.0f}'.format(rule.price_max|float) }} ‚ÇΩ</strong>
            </td>
            <td>
                {% if rule.tier == 'basic' %}
                <span class="badge badge-viewed">–≠–∫–æ–Ω–æ–º</span>
                {% elif rule.tier == 'improved' %}
                <span class="badge badge-contacted">–£–ª—É—á—à–µ–Ω–Ω—ã–π</span>
                {% elif rule.tier == 'original' %}
                <span class="badge badge-won">OEM / –û—Ä–∏–≥–∏–Ω–∞–ª</span>
                {% else %}
                <span class="badge badge-new">–°—Ç–∞–Ω–¥–∞—Ä—Ç</span>
                {% endif %}
            </td>
            <td>{{ rule.warranty_months }} –º–µ—Å.</td>
            <td>
                <a href="/admin/pricing/{{ rule.id }}/edit" class="btn btn-sm btn-outline">‚úèÔ∏è</a>
                <button class="btn btn-sm btn-danger"
                        hx-delete="/admin/pricing/{{ rule.id }}"
                        hx-target="#rule-{{ rule.id }}"
                        hx-swap="outerHTML"
                        data-confirm="–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Ü–µ–Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ?">üóëÔ∏è</button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-state">
    <div class="empty-icon">üí∞</div>
    <h3>–¶–µ–Ω—ã –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã</h3>
    <p>–î–æ–±–∞–≤—å—Ç–µ —Ü–µ–Ω—ã –Ω–∞ —É—Å–ª—É–≥–∏, —á—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –Ω–∞–∑—ã–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º.</p>
    <a href="/admin/pricing/new" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —Ü–µ–Ω—É</a>
</div>
{% endif %}
{% endblock %}
